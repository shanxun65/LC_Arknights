# LC_Arknights
Reset &amp;&amp; Test, author by ayuia &amp; hamg 
Cjw

2025.10.25周学习记录
# 1、学习CAN通信的原理(Controller Area Network)
一、CAN基础认知
1、两根通信线(CNA_H,CAN_L)，可以不共地（一般为稳定还是要共地）
2、差分信号通信
3、异步，无需时钟线
4、半双工，可挂载多设备
5、分为广播式和请求式两种传输方式
二、CAN硬件与物理层
1. 每个节点必须包含CAN控制器和CAN收发器（如TJA1050），二者配合实现信号处理与总线连接。  
2. 高速/低速CAN对比（图片关键表格内容）
| 类型       | 传输速率上限 | 总线结构要求               | 典型应用场景       |
|------------|--------------|----------------------------|--------------------|
| 高速CAN    | 1Mbps        | 双绞线，两端接120Ω终端电阻 | 汽车动力系统       |
| 低速CAN    | 125kbps      | 可无终端电阻，支持星形结构 | 汽车车身舒适系统   |
3. 信号电平特性
显性电平（逻辑0）,显性电平(逻辑1) 
三、CAN帧格式
CAN协议定义5类帧：数据帧、远程帧、错误帧、过载帧、帧间隔，核心为数据帧与远程帧。
数据帧：SOF+ID+RTR+IDE+r0+DLC+Data+CRC+CRC界定符+Ack槽+Ack界定符+EOF
遥控帧无数据段，RTR为1，其他一样
四、位时序与同步
1. 位时间构成
1个位时间 = 同步段（SS）+ 传播段（PS）+ 相位缓冲段1（PBS1）+ 相位缓冲段2（PBS2），单位为时间量子（Tq）。  
示例：SS=1Tq、PS=3Tq、PBS1=4Tq、PBS2=2Tq，总位时间=10Tq；若系统时钟8MHz、分频系数8，则Tq=1μs，波特率=1/(10×1μs)=100kbps。
2. 同步机制
硬同步：仅在帧起始上升沿触发，将节点采样点对齐到该边沿；  
重同步：接收时检测边沿与采样点的相位误差，通过调整PBS1（超前）或PBS2（滞后）同步，最大调整量由重同步跳转宽度（SJW=1-4Tq）决定。
五、总线仲裁与资源分配
1. 仲裁机制
多节点同时发送时，逐位比较ID（从最高位开始），显性位（0）优先于隐性位（1）；  
2. 资源分配规则
先占先得：总线空闲时节点立即发送，忙时等待，可能导致低优先级节点“饥饿”；  
非破坏性仲裁：仲裁失败节点仅退出发送，已发位无需重传，保证效率。
六、错误处理（图片错误类型与状态转换）
1. 5类错误类型
- 位错误：发送位与接收位不一致（仲裁段、ACK槽等特殊段除外）；  
- 填充错误：违反“连续5个同相位后插1个反相位”的位填充规则；  
- CRC错误：接收CRC与本地计算结果不一致；  
- 形式错误：帧格式不符合规范（如帧结束非7位隐性）；  
- 应答错误：发送节点未检测到ACK槽的显性位。
2. 3种错误状态
- **主动错误**：节点正常发送主动错误标志，可参与总线通信；  
- **被动错误**：累计16次主动错误后进入，发送被动错误标志，需等待总线空闲后发送；  
- **总线关闭**：累计16次被动错误后进入，无法发送报文，需满足“连续128个总线空闲”等条件恢复。
七、CAN控制器结构
以通用CAN控制器为例，核心模块如下：
标识符过滤器
  含2个32位过滤寄存器（如R1、R2），可配置FSC（16/32位模式）、FBMx（屏蔽/列表模式）、FACTx（使能），过滤无需接收的报文
# 2、学习git用法
git status查看仓库状态
git add添加到暂存区
git commit提交
git log查看仓库提交历史记录
git reset --soft/hard/mixed撤销工作区、暂存区
git diff比较工作区和暂存区
rm file从工作区删除文件
git branch查看分支
git branch ""创建分支
git switch ""切换分支
git merge